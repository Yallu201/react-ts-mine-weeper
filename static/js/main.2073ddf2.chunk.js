(this["webpackJsonpmine-weeper"]=this["webpackJsonpmine-weeper"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var i=n(1),s=n.n(i),o=n(6),c=n.n(o),u=(n(14),n(15),n(7)),r=n(9),_=n(4),l=n(5),h=n(0),a=function(){function e(t,n){Object(_.a)(this,e),this.__row=null,this.__column=null,this.__isOpened=!1,this.__isMine=!1,this.__isChecked=!1,this.__mineCount=0,this.__row=t,this.__column=n,Object(h.n)(this,{__row:h.o,__column:h.o,__isOpened:h.o,__isMine:h.o,__isChecked:h.o,__mineCount:h.o,open:h.f,check:h.f})}return Object(l.a)(e,[{key:"row",get:function(){return this.__row}},{key:"column",get:function(){return this.__column}},{key:"isOpened",get:function(){return this.__isOpened},set:function(e){this.__isOpened=e}},{key:"isMine",get:function(){return this.__isMine},set:function(e){this.__isMine=e}},{key:"isChecked",get:function(){return this.__isChecked}},{key:"mineCount",get:function(){return this.__mineCount},set:function(e){this.__mineCount=e}},{key:"open",value:function(){this.__isChecked||(this.__isOpened=!0)}},{key:"check",value:function(){this.__isOpened||(this.__isChecked=!this.__isChecked)}}]),e}(),f=function(){function e(t,n){Object(_.a)(this,e),this.__index=null,this.__cells=void 0,this.__index=t,this.__cells=n,Object(h.n)(this,{__index:h.o,__cells:h.o})}return Object(l.a)(e,[{key:"index",get:function(){return this.__index}},{key:"cells",get:function(){return this.__cells},set:function(e){this.__cells=e}},{key:"push",value:function(e){this.__cells.push(e)}}]),e}(),d=n(2),C=function(){function e(){Object(_.a)(this,e),this.__clickCount=0,this.__rowCount=9,this.__columnCount=9,this.__rows=[],this.__openCellCount=0,this.init(),Object(h.n)(this,{__rows:h.o,__rowCount:h.o,__columnCount:h.o,__openCellCount:h.o,push:h.f,setMine:h.f,init:h.f,openMines:h.f,openEmptyCells:h.f,openCell:h.f,addOpenCell:h.f})}return Object(l.a)(e,[{key:"clickCount",get:function(){return this.__clickCount},set:function(e){this.__clickCount=e}},{key:"rows",get:function(){return this.__rows},set:function(e){this.__rows=e}},{key:"openCellCount",get:function(){return this.__openCellCount}},{key:"push",value:function(e){this.__rows.push(e)}},{key:"setMine",value:function(e,t){var n=0===e,i=e===this.__rowCount-1,s=0===t,o=t===this.__columnCount-1;this.__rows[e].cells[t].isMine=!0,n||(s||(this.__rows[e-1].cells[t-1].mineCount+=1),this.__rows[e-1].cells[t].mineCount+=1,o||(this.__rows[e-1].cells[t+1].mineCount+=1)),i||(s||(this.__rows[e+1].cells[t-1].mineCount+=1),this.__rows[e+1].cells[t].mineCount+=1,o||(this.__rows[e+1].cells[t+1].mineCount+=1)),s||(this.__rows[e].cells[t-1].mineCount+=1),o||(this.__rows[e].cells[t+1].mineCount+=1)}},{key:"init",value:function(){this.__clickCount=0,this.__rowCount=9,this.__columnCount=9,this.__rows=[],this.__openCellCount=0;for(var e=0;e<this.__rowCount;e++){for(var t=new f(e,[]),n=0;n<this.__columnCount;n++){var i=new a(e,n);t.push(i)}this.push(t)}}},{key:"openMines",value:function(){this.__rows.forEach((function(e){e.cells.forEach((function(e){e.isMine&&(e.isOpened=!0)}))}))}},{key:"openEmptyCells",value:function(e,t){this.openCell(e,t)}},{key:"openCell",value:function(e,t){var n=this;if(null!==e&&null!==t&&!this.__rows[e].cells[t].isMine&&!this.__rows[e].cells[t].isOpened){if(this.__rows[e].cells[t].mineCount>0)return this.__rows[e].cells[t].open(),void this.addOpenCell();0===this.__rows[e].cells[t].mineCount&&(this.__rows[e].cells[t].open(),this.addOpenCell());[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].forEach((function(i){var s=Object(r.a)(i,2),o=s[0],c=s[1],u=e+o,_=t+c;u<0||u>=n.__rowCount||_<0||_>=n.__columnCount||n.openCell(e+o,t+c)}))}}},{key:"addOpenCell",value:function(){this.__openCellCount+=1}}]),e}(),m=Object(i.createContext)(new C),v=function(e){var t=e.store,n=e.children;return Object(d.jsx)(m.Provider,{value:t,children:n})},O=function(){return Object(i.useContext)(m)},k=function(){function e(){Object(_.a)(this,e),this.__seconds=0,this.__mineCount=10,this.__checkCount=0,this.__interval=null,this.__isGameOver=!1,this.__isGameStart=!1,Object(h.n)(this,{__seconds:h.o,__mineCount:h.o,__checkCount:h.o,leftMineCount:h.g,addSecond:h.f,start:h.f,reset:h.f,gameOver:h.f,addCheckCount:h.f})}return Object(l.a)(e,[{key:"seconds",get:function(){return this.__seconds}},{key:"mineCount",get:function(){return this.__mineCount}},{key:"isGameOver",get:function(){return this.__isGameOver}},{key:"isGameStart",get:function(){return this.__isGameStart}},{key:"leftMineCount",get:function(){return Math.max(0,this.__mineCount-this.__checkCount)}},{key:"addSecond",value:function(){this.__seconds+=1}},{key:"start",value:function(){this.__isGameStart=!0,this.__interval||(this.__interval=setInterval(this.addSecond.bind(this),1e3))}},{key:"reset",value:function(){this.__seconds=0,this.__mineCount=10,this.__checkCount=0,this.__isGameStart=!1,this.__isGameOver=!1,this.__interval&&(clearInterval(this.__interval),this.__interval=null)}},{key:"gameOver",value:function(){this.__isGameOver=!0,this.__interval&&(clearInterval(this.__interval),this.__interval=null)}},{key:"addCheckCount",value:function(e){this.__checkCount+=e}}]),e}(),p=Object(i.createContext)(new k),j=function(e){var t=e.store,n=e.children;return Object(d.jsx)(p.Provider,{value:t,children:n})},b=function(){return Object(i.useContext)(p)},w=Object(u.a)((function(){var e=O(),t=b(),n=Object(i.useCallback)((function(){t.reset(),e.init()}),[t,e]);return Object(d.jsxs)("div",{className:"header-wrap",children:[Object(d.jsx)("input",{type:"text",value:t.leftMineCount}),Object(d.jsx)("button",{onClick:n,children:"reset"}),Object(d.jsx)("input",{type:"text",value:t.seconds})]})})),y=n(3),x=Object(u.a)((function(e){var t=e.cell,n=e.setMine,s=b(),o=O(),c=Object(i.useRef)(null);Object(i.useEffect)((function(){function e(e){e.preventDefault()}function n(e){switch(e.buttons){case 2:var n=t.isChecked?-1:1;s.addCheckCount(n),t.check()}}return c&&c.current&&(c.current.addEventListener("mousedown",n),c.current.addEventListener("contextmenu",e)),function(){c&&c.current&&(c.current.removeEventListener("mousedown",n),c.current.removeEventListener("contextmenu",e))}}),[t]);var u=Object(i.useCallback)((function(){if(!s.isGameOver&&!t.isChecked){if(t.isMine)return o.openMines(),void s.gameOver();s.isGameStart||(n(t.row,t.column),s.start()),0===t.mineCount&&o.openEmptyCells(t.row,t.column),t.isOpened||(t.open(),o.addOpenCell())}}),[n,t,o,s]),r=Object(i.useMemo)((function(){return!t.isMine&&t.isOpened&&t.mineCount>0?t.mineCount:null}),[t.isMine,t.mineCount,t.isOpened]),_=Object(i.useMemo)((function(){var e=t.isOpened?" open":"",n=t.isChecked?" check":"",i=s.isGameOver?" red":"";return"cell".concat(e).concat(n).concat(i)}),[t.isMine,t.isOpened,t.isChecked,s.isGameOver]);return Object(d.jsx)("button",{ref:c,className:_,onClick:u,children:r})})),M=Object(y.c)((function(){var e=O(),t=Object(i.useCallback)((function(t,n){if(!(e.clickCount>0)){e.clickCount+=1;for(var i=new Set;i.size<10;){var s=Math.floor(81*Math.random());if(!i.has(s)){i.add(s);var o=Math.floor(s/9),c=s%9;o===t&&c===n||e.setMine(o,c)}}}}),[e]);return Object(d.jsx)("div",{className:"cell-area-wrap",children:Object(d.jsx)("div",{className:"board",children:e&&e.rows.map((function(e,n){return Object(d.jsx)("div",{className:"row",children:e.cells.map((function(e,i){return Object(d.jsx)(x,{cell:e,setMine:t},"col_".concat(n,"_").concat(i))}))},"row_".concat(n))}))})})}));var g=function(){var e=b(),t=O();return Object(d.jsx)("div",{className:"container",children:Object(d.jsx)(j,{store:e,children:Object(d.jsxs)(v,{store:t,children:[Object(d.jsx)(w,{}),Object(d.jsx)(M,{})]})})})};c.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(g,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.2073ddf2.chunk.js.map